angular.module("cycler",[]).controller("CyclerCtrl",["$scope","$timeout",function(a,b){function c(){f.show="'"+a.transitionIn+"-show-"+a.direction+"'",f.hide="'"+a.transitionOut+"-hide-"+a.direction+"'"}function d(){return k?b.cancel(k):void 0}function e(){function c(){i&&(a.next(),e())}var f=+a.interval;d(),!isNaN(f)&&f>=0&&(k=b(c,f))}var f=this,g=f.slides=[],h=!1,i=!1,j=-1,k=null;a.direction="next",a.transitionIn=a.transitionIn||"fade",a.transitionOut=a.transitionOut||"fade";var l=a.totalSlides=function(){return g.length};this.setActive=function(a){var b=0,c=g.length;for(angular.isNumber(a)||(a=g.indexOf(a)),j=a;c>b;)g[b].active=!1,b++;g[a].active=!0},this.addSlide=function(b){var c=l();g.push(b),1===c||b.active?(f.setActive(c-1),1===c&&a.play()):b.active=!1},this.removeSlide=function(a){var b=g.indexOf(a);g.splice(b,1);var c=l();if(c>0&&a.active){var d=b>=c?b-1:b;f.setActive(d)}},a.slides=function(){return g},a.isActive=function(a){return a.active},a.togglePlay=function(){return h=!h},a.play=function(){i||h||(i=!0,e())},a.pause=function(){h||(i=!1,d())},a.next=function(){j=(j+1)%g.length,a.direction="next",f.setActive(j)},a.prev=function(){j=0>j-1?g.length-1:j-1,a.direction="prev",f.setActive(j)},a.$watch("interval",e),a.$watch("transitionIn+transitionOut+direction",c)}]).directive("cycler",function(){return{replace:!0,restrict:"EA",transclude:!0,controller:"CyclerCtrl",templateUrl:"cycler.html",scope:{size:"=",controls:"=",interval:"=",direction:"=",indicators:"=",transitionIn:"=",transitionOut:"="},link:function(a,b){var c=["xl","l","m","s"];a.$watch("size",function(d){a.size=d=d||"xl",-1===c.indexOf(d)&&(b.removeClass(),b.addClass(""+d+" cycler"))})}}}).directive("slide",["$animator",function(a){return{replace:!0,require:"^cycler",restrict:"EA",transclude:!0,templateUrl:"slide.html",scope:{active:"="},link:function(b,c,d,e){function f(){var c={ngAnimate:"{show:"+e.show+",hide:"+e.hide+"}"};g=a(b,c)}var f,g=null;e.addSlide(b,c),b.$watch(function(){return e.show},f),b.$watch(function(){return e.hide},f),f(),b.$on("$destroy",function(){e.removeSlide(b)}),b.$watch("active",function(a){a?(e.setActive(b),g.show(c)):g.hide(c)})}}}]);